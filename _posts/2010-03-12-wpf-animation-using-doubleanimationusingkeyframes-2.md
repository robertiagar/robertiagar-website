---
layout: post
title: WPF Animation using DoubleAnimationUsingKeyFrames
date: 2010-03-12 12:47
author: "Robert Iagar"
comments: true
tags: [Design, WPF]
---
<p align="justify">Every body knows that Windows Presentation Foundation provides better support for UI than WinForms does in .NET 3.5 (and RC .NET 4). </p>  <p align="justify">You can make very beautiful application UI using Visual Studio 2008 (or the new Visual Studio 2010), but this requires very good knowledge of XAML or use other WPF design based application like Microsoft Expression Blend. I for one don’t afford Blend and had to rely entirely on Visual Studio 2010. That’s my way of learning WPF design. Code and if I get no errors see what the code does.</p>  <p align="justify">In this post I’ll show how to make a button “disappear” from a window and come back using a Storyboard that contains a DoubleAnimationUsingKeyFrames.</p>  <div align="justify"><a name='more'></a></div>  <h3 align="justify">Setting up the window and button</h3>  <p align="justify">Right open up Visual Studio 2010 RC1 (Visual Studio 2008 Pro and Express editions will work just as well) and create a new project. From the New Project Window select Windows from your language of choosing and select a WpfApplication.</p>  <p align="justify"><a href="http://robertiagar.files.wordpress.com/2010/03/image1.png"><img title="image" border="0" alt="image" src="http://robertiagar.files.wordpress.com/2010/03/image_thumb1.png" width="244" height="170" /></a></p>  <p align="justify">Visual Studio will create all the necessary files and open up your MainWindow.xaml in split mode (where you have the design at the top and the XAML at the bottom) with the following code:</p>  <p align="justify">&lt;Window x:Class=&quot;WpfAnimationUsingKeyFrames.MainWindow&quot;    <br />        xmlns="<a>http://schemas.microsoft.com/winfx/2006/xaml/presentation"</a>     <br />        xmlns:x="<a>http://schemas.microsoft.com/winfx/2006/xaml"</a>     <br />        Title="MainWindow" Height="350" Width="525"&gt;     <br />     </p>  <p align="justify">        <br /></p>  <p align="justify">Now lets add a button to our window. Add the following markup:</p>  <p align="justify">&lt;Button x:Name=”Move”    <br />        Content="Move!"     <br />        Margin="3" Padding="10"     <br />        HorizontalAlignment="Center"     <br />        VerticalAlignment="Center"&gt;     <br /></p>  <p align="justify">We’re done with setting up the window. So for you should have the following result:</p>  <p align="justify"><a href="http://robertiagar.files.wordpress.com/2010/03/image2.png"><img title="image" border="0" alt="image" src="http://robertiagar.files.wordpress.com/2010/03/image_thumb2.png" width="244" height="133" /></a></p>  <h3 align="justify">Setting up RenderTransform</h3>  <p align="justify">Now that we have our up we should add some RenderTransform properties to our button. We need to do this otherwise we won’t have what to animate in our storyboard when we’ll set up later.</p>  <p align="justify">Between your  tags add the following markup:</p>  <p align="justify">    <br />                     <br /></p>  <p align="justify">Great! (Cheering up myself for typing this much so far) Now we have what to animate when we write our storyboard.</p>  <h3 align="justify">Setting up the Storyboard</h3>  <p align="justify">Now that we have our button and the button is ready to accept render transformations lets write the storyboard.</p>  <p align="justify">Right before the  tag (which is the opening tag for our grid) add the following markup:</p>  <p align="justify">    <br />    <br />    <br /></p>  <p align="justify">We’ll define our storyboard in the windows resources. Not sure, but I think this is the only. If some WPF developer will scream in the comments that this is all wrong, sorry, but this is how it worked for me.</p>  <p align="justify">Moving on. Time to finally write the storyboard. I’ll write to whole markup and explain everything afterwards. It’s not complicated just bare with me on this. Between the Window.Resources tags write the following markup:</p>  <p align="justify">    <br />    &lt;DoubleAnimationUsingKeyFrames BeginTime=&quot;00:00:00&quot;     <br />                                   Storyboard.TargetName="Move" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"&gt;     <br />             <br />             <br />             <br />             <br />             <br />         <br /></p>  <p align="justify">Time for the explaining part. Hope I don’t get this wrong.    <br />So first of all the x:Key property of a storyboard is required in everything you declare in your windows resources. If you don’t do that you’ get an error.     <br />Every storyboard needs to contain an Animation. It’s the only child the container of a storyboard accepts. If you attempt to add a button to a storyboard you get an error.     <br />There are several animation’s depending on what kind of property values are your trying to animate. In this case we’re animating a Double value in the TranslateTransform’s X property, which is a Double. That’s why we have DoubleAnimation. The UsingKeyFrames is there because we are obviously using KeyFrames to animate. I’m using key frames because  I’ve done some work in Adobe After Effects and I’m to animating with Key Frames.</p>  <p align="justify">   <br />The BeginTime property of the animation is when the animation starts. This property is a TimeSpan value. XAML is intelligent enough convert the “00:00:00” string to TimeSpan.     <br />Storyboard.TargetName sets the storyboard target to an element name, in this case to our Button which has x:Name property set to “Move”.     <br />Storyboard.TargetProperty sets the storyboard target property to a property of the element which has the name set in Storyboard.TargetName property. The value of this property is bit hard to add at first but when you know how to determine what type of property is any property will be easy. If you hover over property name in Visual Studio you get a tooltip that says the full length of the property.</p>  <p align="justify"><a href="http://robertiagar.files.wordpress.com/2010/03/image3.png"><img title="image" border="0" alt="image" src="http://robertiagar.files.wordpress.com/2010/03/image_thumb3.png" width="244" height="133" /></a></p>  <p align="justify">Always remember to add the property into brackets (e.g. “(PropertyPath)” ). XAML will always convert to see it’s a correct property name and give an error if it’s not.    <br />Once you told the animation what element to target and what property of that element to animate, it’s time to set up the key frames.     <br />In the DoubleAnimationUsingKeyFrames tags add a SplineDoubleKeyFrame. You can add as many of these as you want.     <br />The KeyTime and Value properties say that at the value of the KeyTime, the Value of the property specified in the Storyboard.TargetProperty is the same with Value. The thing is that between “00:00:00” and “00:00:00.0100” the value animates to 10. At time “00:00:00.0050” you won’t have 0. You’ll have a value between 0 and 10. Pretty nice eh? The same principle applies to al SplineDoubleKeyFrame’s.</p>  <p align="justify">Now that we have defined our Storyboard it’s time to tell to button when to animate.</p>  <h3>Starting the Storyboard</h3>  <p align="justify">Just right before the end of  tag add the following markup:    <br />     <br />         <br />             <br />         <br /> </p>  <p>Now when you click the button it will animate. Press F5 to debug and see what we have created.</p>  <p>The storyboard can be started in the Code-behind. If you want to add more code when you click the button you need set button’s Click event to an event handler. Remove the markup I told you to write above and modify the  to show the following:    <br />&lt;Button x:Name=&quot;Move&quot;     <br />        Content="Move!"     <br />        Margin="3" Padding="10"     <br />        HorizontalAlignment="Center"     <br />        VerticalAlignment="Center"     <br />        Click="Move_Click"&gt;     <br />         <br />             <br />         <br /></p>  <p>Now in the code-behind write to following code in Window Class:    <br />private void Move_Click(object sender, RoutedEventArgs e)     <br />{     <br />    (Resources["Move"] as Storyboard).Begin();     <br />}</p>  <p>Be sure to add the following reference in your using section:    <br />using System.Windows.Media.Animation; </p>  <h3>Done</h3>  <p>That’s it! You’re done. Hope you found this post helpful as I found it fun to write. If I made some mistakes in my explanations or if I said some wrong/stupid things please do say it in the comments.</p>  <p>Looking forward for some feedback.</p>  <h3>Full XAML with EventTriggers:    <br /></h3>  <p>&lt;Window x:Class=&quot;WpfAnimationUsingKeyFrames.MainWindow&quot;    <br />        xmlns="<a>http://schemas.microsoft.com/winfx/2006/xaml/presentation"</a>     <br />        xmlns:x="<a>http://schemas.microsoft.com/winfx/2006/xaml"</a>     <br />        Title="MainWindow" Height="350" Width="525"&gt;     <br />         <br />             <br />            &lt;DoubleAnimationUsingKeyFrames BeginTime=&quot;00:00:00&quot;     <br />                                           Storyboard.TargetName="Move" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"&gt;     <br />                     <br />                     <br />                     <br />                     <br />                     <br />                 <br />             <br />         <br />         <br />        &lt;Button x:Name=&quot;Move&quot;     <br />                Content="Move!"     <br />                Margin="3" Padding="10"     <br />                HorizontalAlignment="Center"     <br />                VerticalAlignment="Center"&gt;     <br />                 <br />                     <br />                 <br />                 <br />                     <br />                         <br />                     <br />                 <br />             <br />         <br /></p>  <h3>Full XAML with Click Event &amp; Full Code-behind</h3>  <h5></h5>  <p><strong>XAML:</strong>     <br />&lt;Window x:Class=&quot;WpfAnimationUsingKeyFrames.MainWindow&quot;     <br />        xmlns="<a>http://schemas.microsoft.com/winfx/2006/xaml/presentation"</a>     <br />        xmlns:x="<a>http://schemas.microsoft.com/winfx/2006/xaml"</a>     <br />        Title="MainWindow" Height="350" Width="525"&gt;     <br />         <br />             <br />            &lt;DoubleAnimationUsingKeyFrames BeginTime=&quot;00:00:00&quot;     <br />                                           Storyboard.TargetName="Move" Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"&gt;     <br />                     <br />                     <br />                     <br />                     <br />                     <br />                 <br />             <br />         <br />         <br />        &lt;Button x:Name=&quot;Move&quot;     <br />                Content="Move!"     <br />                Margin="3" Padding="10"     <br />                HorizontalAlignment="Center"     <br />                VerticalAlignment="Center"     <br />                Click="Move_Click"&gt;     <br />                 <br />                     <br />                 <br />             <br />         <br /></p>  <p><strong>Code-behind:</strong><strong></strong> </p>  <p>using System.Windows;   <br />using System.Windows.Media.Animation; </p>  <p>namespace WpfAnimationUsingKeyFrames    <br />{     <br />    /// <summary>     <br />    /// Interaction logic for MainWindow.xaml     <br />    /// </summary>     <br />    public partial class MainWindow : Window     <br />    {     <br />        public MainWindow()     <br />        {     <br />            InitializeComponent();     <br />        } </p>  <p>        private void Move_Click(object sender, RoutedEventArgs e)    <br />        {     <br />            (Resources["Move"] as Storyboard).Begin();     <br />        }     <br />    }     <br />}<strong> </strong>//Removed unused using;    </p>
